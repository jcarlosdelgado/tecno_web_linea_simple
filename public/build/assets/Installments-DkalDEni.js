import{r as V,c as v,a as l,b as d,u as y,h as z,w as r,d as e,t as o,P as I,o as n,F as w,f as B,q as T,i as g,g as M,e as u,p as E,M as F}from"./app-BlCBzDlk.js";import{_ as $}from"./AuthenticatedLayout-DQ_849qa.js";import{_ as k}from"./Card-O9o5eUXT.js";import{_ as x}from"./Button-CX2Fugjk.js";import{_ as P}from"./Badge-DUws-gGn.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Footer-o2Y0PLgd.js";import"./ResponsiveNavLink-BzKXVlKb.js";const L={class:"flex justify-between items-center"},S={class:"font-semibold text-xl text-gray-800 leading-tight"},q={class:"py-12"},H={class:"max-w-6xl mx-auto sm:px-6 lg:px-8 space-y-6"},O={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},R={class:"text-center"},Q={class:"text-2xl font-bold text-gray-900"},J={class:"text-center"},K={class:"text-2xl font-bold text-indigo-600"},U={class:"text-center"},W={class:"text-2xl font-bold text-green-600"},X={class:"text-center"},Y={class:"text-2xl font-bold text-orange-600"},Z={class:"mt-6"},ee={class:"flex justify-between items-center mb-2"},te={class:"text-sm font-medium text-gray-700"},se={class:"w-full bg-gray-200 rounded-full h-3"},ae={class:"space-y-4"},oe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},ne={class:"flex-1"},le={class:"flex items-center gap-3 mb-2"},re={class:"text-lg font-semibold text-gray-900"},ie={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},de={class:"ml-2 font-semibold text-gray-900"},ce={class:"ml-2 font-medium text-gray-900"},ue={key:0},me={class:"ml-2 font-medium text-green-600"},ge={key:0,class:"flex-shrink-0"},fe={key:1,class:"flex-shrink-0 flex gap-2"},pe={key:0,class:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},ve={class:"flex"},xe={class:"text-sm text-blue-800"},_e={class:"list-disc list-inside space-y-1"},be={key:0},he={key:1,class:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4"},ye={__name:"Installments",props:{pago:Object,cuotas:Array,trabajo:Object},setup(i){const m=i,c=V(null),_=v(()=>m.cuotas.filter(s=>s.estado==="PENDIENTE").length),f=v(()=>m.cuotas.filter(s=>s.estado==="PAGADA").length),b=v(()=>f.value/m.cuotas.length*100),C=s=>({PENDIENTE:"warning",PAGADA:"success",VENCIDA:"danger"})[s]||"default",D=s=>({PENDIENTE:"Pendiente",PAGADA:"Pagada",VENCIDA:"Vencida"})[s]||s,N=async s=>{if(s.estado!=="PENDIENTE"){alert("Esta cuota ya ha sido pagada o está vencida.");return}c.value=s.id_cuota;try{(await F.post(route("cuotas.generateQR",s.id_cuota))).data.success?E.visit(route("pagos.checkout",m.pago.id_pago)):alert("Error al generar QR para la cuota")}catch(t){console.error("Error:",t),alert("Error al procesar el pago de la cuota")}finally{c.value=null}},h=s=>s?new Date(s).toLocaleDateString("es-BO",{year:"numeric",month:"long",day:"numeric"}):"-",p=s=>s.estado!=="PENDIENTE"?!1:new Date(s.fecha_vencimiento)<new Date,A=s=>{window.open(route("cuotas.descargar-comprobante",s),"_blank")};return(s,t)=>(n(),l(w,null,[d(y(z),{title:"Mis Cuotas"}),d($,null,{header:r(()=>[e("div",L,[e("h2",S," Plan de Cuotas - "+o(i.trabajo.titulo),1),d(x,{variant:"secondary",size:"sm",onClick:t[0]||(t[0]=a=>y(E).visit(s.route("trabajos.show",i.trabajo.id_trabajo)))},{default:r(()=>[...t[1]||(t[1]=[u(" Volver al Trabajo ",-1)])]),_:1})])]),default:r(()=>[e("div",q,[e("div",H,[d(k,{title:"Resumen del Plan de Pagos"},{default:r(()=>[e("div",O,[e("div",R,[t[2]||(t[2]=e("p",{class:"text-sm text-gray-500 mb-1"},"Total del Trabajo",-1)),e("p",Q,"Bs "+o(parseFloat(i.pago.monto).toFixed(2)),1)]),e("div",J,[t[3]||(t[3]=e("p",{class:"text-sm text-gray-500 mb-1"},"Número de Cuotas",-1)),e("p",K,o(i.pago.numero_cuotas),1)]),e("div",U,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-500 mb-1"},"Cuotas Pagadas",-1)),e("p",W,o(f.value)+" / "+o(i.cuotas.length),1)]),e("div",X,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-500 mb-1"},"Cuotas Pendientes",-1)),e("p",Y,o(_.value),1)])]),e("div",Z,[e("div",ee,[t[6]||(t[6]=e("span",{class:"text-sm font-medium text-gray-700"},"Progreso de Pagos",-1)),e("span",te,o(b.value.toFixed(0))+"%",1)]),e("div",se,[e("div",{class:"bg-gradient-to-r from-indigo-500 to-indigo-600 h-3 rounded-full transition-all duration-500",style:I({width:b.value+"%"})},null,4)])])]),_:1}),d(k,{title:"Detalle de Cuotas"},{default:r(()=>[e("div",ae,[(n(!0),l(w,null,B(i.cuotas,a=>(n(),l("div",{key:a.id_cuota,class:T(["border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",{"bg-green-50 border-green-200":a.estado==="PAGADA","bg-red-50 border-red-200":p(a),"bg-white":a.estado==="PENDIENTE"&&!p(a)}])},[e("div",oe,[e("div",ne,[e("div",le,[e("h4",re," Cuota "+o(a.numero_cuota)+" de "+o(i.pago.numero_cuotas),1),d(P,{variant:C(a.estado)},{default:r(()=>[u(o(D(a.estado)),1)]),_:2},1032,["variant"]),p(a)?(n(),M(P,{key:0,variant:"danger"},{default:r(()=>[...t[7]||(t[7]=[u(" Vencida ",-1)])]),_:1})):g("",!0)]),e("div",ie,[e("div",null,[t[8]||(t[8]=e("span",{class:"text-gray-500"},"Monto:",-1)),e("span",de,"Bs "+o(parseFloat(a.monto).toFixed(2)),1)]),e("div",null,[t[9]||(t[9]=e("span",{class:"text-gray-500"},"Vencimiento:",-1)),e("span",ce,o(h(a.fecha_vencimiento)),1)]),a.fecha_pago?(n(),l("div",ue,[t[10]||(t[10]=e("span",{class:"text-gray-500"},"Fecha de Pago:",-1)),e("span",me,o(h(a.fecha_pago)),1)])):g("",!0)])]),a.estado==="PENDIENTE"?(n(),l("div",ge,[d(x,{onClick:j=>N(a),variant:"primary",loading:c.value===a.id_cuota,disabled:c.value!==null&&c.value!==a.id_cuota},{default:r(()=>[...t[11]||(t[11]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),u(" Pagar Ahora ",-1)])]),_:1},8,["onClick","loading","disabled"])])):a.estado==="PAGADA"?(n(),l("div",fe,[t[13]||(t[13]=e("div",{class:"flex items-center text-green-600"},[e("svg",{class:"w-6 h-6 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("span",{class:"font-medium"},"Pagada")],-1)),d(x,{variant:"success",size:"sm",onClick:j=>A(a.id_cuota)},{default:r(()=>[...t[12]||(t[12]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),u(" Comprobante ",-1)])]),_:1},8,["onClick"])])):g("",!0)])],2))),128))]),_.value>0?(n(),l("div",pe,[e("div",ve,[t[17]||(t[17]=e("svg",{class:"w-5 h-5 text-blue-600 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",xe,[t[16]||(t[16]=e("p",{class:"font-medium mb-1"},"Información importante:",-1)),e("ul",_e,[f.value===0?(n(),l("li",be,"El trabajo iniciará después de que pagues la primera cuota.")):g("",!0),t[14]||(t[14]=e("li",null,"Puedes pagar tus cuotas en cualquier momento antes de su vencimiento.",-1)),t[15]||(t[15]=e("li",null,"El trabajo se marcará como finalizado cuando todas las cuotas estén pagadas y el progreso sea del 100%.",-1))])])])])):(n(),l("div",he,[...t[18]||(t[18]=[e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-green-600 mr-3",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("p",{class:"text-sm font-medium text-green-800"}," ¡Felicidades! Has completado el pago de todas las cuotas. ")],-1)])]))]),_:1})])])]),_:1})],64))}},je=G(ye,[["__scopeId","data-v-6a4070fa"]]);export{je as default};
