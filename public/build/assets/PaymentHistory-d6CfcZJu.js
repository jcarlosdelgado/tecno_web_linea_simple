import{r as F,c as I,a as c,b as d,u as V,h as B,w as l,d as t,g as p,i as x,t as o,o as i,q as f,F as v,f as h,e as m,p as _}from"./app-BlCBzDlk.js";import{_ as j}from"./AuthenticatedLayout-DQ_849qa.js";import{_ as g}from"./Card-O9o5eUXT.js";import{_ as y}from"./Button-CX2Fugjk.js";import{_ as A}from"./Badge-DUws-gGn.js";import"./Footer-o2Y0PLgd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BzKXVlKb.js";const M={class:"py-12"},$={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},G={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},S={class:"text-center"},L={class:"text-3xl font-bold text-gray-900"},R={class:"mt-2 flex justify-center items-center gap-3 text-xs"},z={class:"text-blue-600"},H={class:"text-purple-600"},q={class:"text-center"},J={class:"text-3xl font-bold text-gray-900"},K={class:"text-center"},Q={class:"text-3xl font-bold text-green-600"},U={class:"text-center"},W={class:"text-3xl font-bold text-orange-600"},X={class:"grid grid-cols-3 gap-6 text-center"},Y={class:"text-2xl font-bold text-gray-900"},Z={class:"text-2xl font-bold text-green-600"},tt={class:"text-2xl font-bold text-orange-600"},st={class:"flex items-center gap-4"},et={class:"flex gap-2"},at={class:"space-y-4"},ot={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},nt={class:"flex-1"},lt={class:"flex items-center gap-3 mb-2"},rt={class:"text-lg font-semibold text-gray-900"},it={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mt-3"},dt={class:"ml-2 font-semibold text-gray-900"},ut={class:"ml-2 font-medium text-gray-900"},ct={key:0},gt={class:"ml-2 font-medium text-gray-900"},xt={key:0,class:"mt-4 flex gap-2 flex-wrap"},mt={key:0,class:"px-2 py-1 text-xs text-gray-500"},pt={class:"flex flex-col gap-2"},ft={class:"text-center py-12"},vt={class:"mt-1 text-sm text-gray-500"},Pt={__name:"PaymentHistory",props:{pagos:Array,stats:Object},setup(r){const b=r,u=F("TODOS"),C=I(()=>u.value==="TODOS"?b.pagos:b.pagos.filter(e=>e.tipo_pago===u.value)),O=e=>({PENDIENTE:"warning",PAGADA:"success",COMPLETADO:"success",VENCIDA:"danger"})[e]||"default",P=e=>({PENDIENTE:"Pendiente",PAGADA:"Pagada",COMPLETADO:"Completado",VENCIDA:"Vencida"})[e]||e,T=e=>e?new Date(e).toLocaleDateString("es-BO",{year:"numeric",month:"short",day:"numeric"}):"-",D=e=>e.tipo_pago==="CONTADO"?e.pasarela?.estado||"PENDIENTE":e.cuotas.every(n=>n.estado==="PAGADA")?"COMPLETADO":e.cuotas.some(n=>n.estado==="PAGADA")?"PARCIAL":"PENDIENTE",k=e=>{e.tipo_pago==="CREDITO"?_.visit(route("cuotas.index",e.id_pago)):_.visit(route("pagos.checkout",e.id_pago))},E=e=>{_.visit(route("trabajos.show",e))},w=e=>{window.open(route("pagos.descargar-comprobante",e),"_blank")},N=e=>e.tipo_pago==="CONTADO"?e.estado==="PAGADO"||e.pasarela?.estado==="COMPLETADO":e.cuotas.some(s=>s.estado==="PAGADA");return(e,s)=>(i(),c(v,null,[d(V(B),{title:"Historial de Pagos"}),d(j,null,{header:l(()=>[...s[3]||(s[3]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Historial de Pagos ",-1)])]),default:l(()=>[t("div",M,[t("div",$,[t("div",G,[d(g,null,{default:l(()=>[t("div",S,[s[4]||(s[4]=t("p",{class:"text-sm text-gray-500 mb-1"},"Total Pagos",-1)),t("p",L,o(r.stats.total_pagos),1),t("div",R,[t("span",z,o(r.stats.pagos_contado)+" contado",1),t("span",H,o(r.stats.pagos_credito)+" crédito",1)])])]),_:1}),d(g,null,{default:l(()=>[t("div",q,[s[5]||(s[5]=t("p",{class:"text-sm text-gray-500 mb-1"},"Monto Total",-1)),t("p",J,"Bs "+o(parseFloat(r.stats.monto_total).toFixed(2)),1)])]),_:1}),d(g,null,{default:l(()=>[t("div",K,[s[6]||(s[6]=t("p",{class:"text-sm text-gray-500 mb-1"},"Pagado",-1)),t("p",Q,"Bs "+o(parseFloat(r.stats.monto_pagado).toFixed(2)),1)])]),_:1}),d(g,null,{default:l(()=>[t("div",U,[s[7]||(s[7]=t("p",{class:"text-sm text-gray-500 mb-1"},"Pendiente",-1)),t("p",W,"Bs "+o(parseFloat(r.stats.monto_pendiente).toFixed(2)),1)])]),_:1})]),r.stats.pagos_credito>0?(i(),p(g,{key:0},{default:l(()=>[t("div",X,[t("div",null,[s[8]||(s[8]=t("p",{class:"text-sm text-gray-500"},"Total Cuotas",-1)),t("p",Y,o(r.stats.total_cuotas),1)]),t("div",null,[s[9]||(s[9]=t("p",{class:"text-sm text-gray-500"},"Cuotas Pagadas",-1)),t("p",Z,o(r.stats.cuotas_pagadas),1)]),t("div",null,[s[10]||(s[10]=t("p",{class:"text-sm text-gray-500"},"Cuotas Pendientes",-1)),t("p",tt,o(r.stats.cuotas_pendientes),1)])])]),_:1})):x("",!0),d(g,null,{default:l(()=>[t("div",st,[s[11]||(s[11]=t("span",{class:"text-sm font-medium text-gray-700"},"Filtrar por:",-1)),t("div",et,[t("button",{onClick:s[0]||(s[0]=a=>u.value="TODOS"),class:f(["px-4 py-2 text-sm rounded-lg transition-colors",u.value==="TODOS"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Todos ("+o(r.stats.total_pagos)+") ",3),t("button",{onClick:s[1]||(s[1]=a=>u.value="CONTADO"),class:f(["px-4 py-2 text-sm rounded-lg transition-colors",u.value==="CONTADO"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Contado ("+o(r.stats.pagos_contado)+") ",3),t("button",{onClick:s[2]||(s[2]=a=>u.value="CREDITO"),class:f(["px-4 py-2 text-sm rounded-lg transition-colors",u.value==="CREDITO"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Crédito ("+o(r.stats.pagos_credito)+") ",3)])])]),_:1}),C.value.length>0?(i(),p(g,{key:1},{default:l(()=>[t("div",at,[(i(!0),c(v,null,h(C.value,a=>(i(),c("div",{key:a.id_pago,class:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow bg-white"},[t("div",ot,[t("div",nt,[t("div",lt,[t("h3",rt,o(a.trabajo.titulo),1),d(A,{variant:a.tipo_pago==="CONTADO"?"default":"info"},{default:l(()=>[m(o(a.tipo_pago),1)]),_:2},1032,["variant"]),d(A,{variant:O(D(a))},{default:l(()=>[m(o(P(D(a))),1)]),_:2},1032,["variant"])]),t("div",it,[t("div",null,[s[12]||(s[12]=t("span",{class:"text-gray-500"},"Monto Total:",-1)),t("span",dt,"Bs "+o(parseFloat(a.monto).toFixed(2)),1)]),t("div",null,[s[13]||(s[13]=t("span",{class:"text-gray-500"},"Fecha:",-1)),t("span",ut,o(T(a.fecha)),1)]),a.tipo_pago==="CREDITO"?(i(),c("div",ct,[s[14]||(s[14]=t("span",{class:"text-gray-500"},"Cuotas:",-1)),t("span",gt,o(a.cuotas.filter(n=>n.estado==="PAGADA").length)+" / "+o(a.numero_cuotas)+" pagadas ",1)])):x("",!0)]),a.tipo_pago==="CREDITO"?(i(),c("div",xt,[(i(!0),c(v,null,h(a.cuotas.slice(0,4),n=>(i(),c("div",{key:n.id_cuota,class:f(["px-2 py-1 rounded text-xs font-medium",{"bg-green-100 text-green-700":n.estado==="PAGADA","bg-orange-100 text-orange-700":n.estado==="PENDIENTE","bg-red-100 text-red-700":n.estado==="VENCIDA"}])}," C"+o(n.numero_cuota)+": Bs "+o(parseFloat(n.monto).toFixed(2)),3))),128)),a.cuotas.length>4?(i(),c("span",mt," +"+o(a.cuotas.length-4)+" más ",1)):x("",!0)])):x("",!0)]),t("div",pt,[d(y,{variant:"primary",size:"sm",onClick:n=>k(a)},{default:l(()=>[m(o(a.tipo_pago==="CREDITO"?"Ver Plan de Cuotas":"Ver Pago"),1)]),_:2},1032,["onClick"]),N(a)?(i(),p(y,{key:0,variant:"success",size:"sm",onClick:n=>w(a.id_pago)},{default:l(()=>[...s[15]||(s[15]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),m(" Descargar Comprobante ",-1)])]),_:1},8,["onClick"])):x("",!0),d(y,{variant:"secondary",size:"sm",onClick:n=>E(a.id_trabajo)},{default:l(()=>[...s[16]||(s[16]=[m(" Ver Trabajo ",-1)])]),_:1},8,["onClick"])])])]))),128))])]),_:1})):(i(),p(g,{key:2},{default:l(()=>[t("div",ft,[s[17]||(s[17]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),s[18]||(s[18]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay pagos",-1)),t("p",vt," Aún no has realizado pagos"+o(u.value!=="TODOS"?" de tipo "+u.value:"")+". ",1)])]),_:1}))])])]),_:1})],64))}};export{Pt as default};
