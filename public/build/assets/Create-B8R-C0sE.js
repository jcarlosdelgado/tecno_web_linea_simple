import{m as U,c as q,D as M,a as d,b as u,u as r,h as $,w as p,d as o,n as N,i as c,j as g,q as f,o as l,F as x,f as y,t as i,k as S,e as _,v as b,l as D}from"./app-BlCBzDlk.js";import{_ as E}from"./AuthenticatedLayout-DQ_849qa.js";import{_ as F}from"./Card-O9o5eUXT.js";import{_ as k}from"./Button-CX2Fugjk.js";import"./Footer-o2Y0PLgd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BzKXVlKb.js";const P={class:"py-12"},B={class:"max-w-3xl mx-auto sm:px-6 lg:px-8"},T={class:"border-2 border-indigo-200 rounded-lg p-4 bg-indigo-50"},j=["value"],A={key:0,class:"mt-1 text-sm text-red-600"},I={key:0,class:"mt-1 text-sm text-red-600"},L={key:0,class:"mt-1 text-sm text-red-600"},O={key:0,class:"mt-1 text-sm text-red-600"},R={key:0,class:"border-2 border-gray-200 rounded-lg p-4"},G={class:"text-lg font-semibold text-gray-900 mb-3"},H={class:"space-y-4"},J={class:"bg-gray-50 px-4 py-2 border-b border-gray-200"},K={class:"font-medium text-gray-900 capitalize"},Q={class:"p-4 bg-white grid grid-cols-1 md:grid-cols-2 gap-3"},W=["id","checked","onChange"],X=["for"],Y={class:"font-medium text-gray-900"},Z={class:"text-gray-500 text-xs"},ee={class:"mt-4 p-3 bg-green-50 rounded-lg"},oe={class:"text-sm font-medium text-green-900"},se={class:"flex items-center justify-end gap-4 pt-4"},ue={__name:"Create",props:{roles:Array},setup(v){const h=v,s=U({nombre:"",email:"",password:"",telefono:"",direccion:"",id_rol:"",permisos_personalizados:[]}),m=q(()=>h.roles?.find(n=>n.id_rol===s.id_rol));M(()=>s.id_rol,n=>{n&&m.value?s.permisos_personalizados=m.value.permisos.map(e=>e.id_permiso):s.permisos_personalizados=[]});const C=n=>{const e=s.permisos_personalizados.indexOf(n);e>-1?s.permisos_personalizados.splice(e,1):s.permisos_personalizados.push(n)},z=n=>n.reduce((e,t)=>(e[t.modulo]||(e[t.modulo]=[]),e[t.modulo].push(t),e),{}),V=()=>{s.post(route("admin.usuarios.store"))};return(n,e)=>(l(),d(x,null,[u(r($),{title:"Crear Usuario"}),u(E,null,{header:p(()=>[...e[6]||(e[6]=[o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Crear Usuario ",-1)])]),default:p(()=>[o("div",P,[o("div",B,[u(F,null,{default:p(()=>[o("form",{onSubmit:N(V,["prevent"]),class:"space-y-6"},[o("div",T,[e[8]||(e[8]=o("label",{class:"block text-sm font-semibold text-indigo-900 mb-2"}," Rol del Empleado * ",-1)),g(o("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>r(s).id_rol=t),required:"",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.id_rol}])},[e[7]||(e[7]=o("option",{value:""},"Selecciona un rol...",-1)),(l(!0),d(x,null,y(v.roles,t=>(l(),d("option",{key:t.id_rol,value:t.id_rol},i(t.nombre)+" - "+i(t.permisos?.length||0)+" permisos ",9,j))),128))],2),[[S,r(s).id_rol]]),r(s).errors.id_rol?(l(),d("p",A,i(r(s).errors.id_rol),1)):c("",!0),e[9]||(e[9]=o("p",{class:"mt-2 text-sm text-indigo-700"},[o("strong",null,"Información:"),o("br"),_(" Este usuario será un "),o("strong",null,"empleado"),_(" del sistema con los permisos que defina el rol seleccionado. ")],-1))]),o("div",null,[e[10]||(e[10]=o("label",{class:"block text-sm font-medium text-gray-700"}," Nombre Completo * ",-1)),g(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r(s).nombre=t),type:"text",required:"",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.nombre}])},null,2),[[b,r(s).nombre]]),r(s).errors.nombre?(l(),d("p",I,i(r(s).errors.nombre),1)):c("",!0)]),o("div",null,[e[11]||(e[11]=o("label",{class:"block text-sm font-medium text-gray-700"}," Correo Electrónico * ",-1)),g(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r(s).email=t),type:"email",required:"",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.email}])},null,2),[[b,r(s).email]]),r(s).errors.email?(l(),d("p",L,i(r(s).errors.email),1)):c("",!0)]),o("div",null,[e[12]||(e[12]=o("label",{class:"block text-sm font-medium text-gray-700"}," Contraseña * ",-1)),g(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r(s).password=t),type:"password",required:"",minlength:"8",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.password}])},null,2),[[b,r(s).password]]),e[13]||(e[13]=o("p",{class:"mt-1 text-sm text-gray-500"},"Mínimo 8 caracteres",-1)),r(s).errors.password?(l(),d("p",O,i(r(s).errors.password),1)):c("",!0)]),o("div",null,[e[14]||(e[14]=o("label",{class:"block text-sm font-medium text-gray-700"}," Teléfono ",-1)),g(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>r(s).telefono=t),type:"tel",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,r(s).telefono]])]),o("div",null,[e[15]||(e[15]=o("label",{class:"block text-sm font-medium text-gray-700"}," Dirección ",-1)),g(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>r(s).direccion=t),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,r(s).direccion]])]),m.value&&m.value.permisos?(l(),d("div",R,[o("h3",G," Personalizar Permisos para "+i(m.value.nombre),1),e[16]||(e[16]=o("p",{class:"text-sm text-gray-600 mb-4"}," Marca o desmarca los permisos específicos que tendrá este empleado ",-1)),o("div",H,[(l(!0),d(x,null,y(z(m.value.permisos),(t,w)=>(l(),d("div",{key:w,class:"border border-gray-200 rounded-lg overflow-hidden"},[o("div",J,[o("h4",K,i(w),1)]),o("div",Q,[(l(!0),d(x,null,y(t,a=>(l(),d("div",{key:a.id_permiso,class:"flex items-start"},[o("input",{id:`permiso-${a.id_permiso}`,type:"checkbox",checked:r(s).permisos_personalizados.includes(a.id_permiso),onChange:re=>C(a.id_permiso),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded mt-0.5"},null,40,W),o("label",{for:`permiso-${a.id_permiso}`,class:"ml-3 text-sm cursor-pointer"},[o("span",Y,i(a.nombre.replace(/_/g," ")),1),o("p",Z,i(a.descripcion),1)],8,X)]))),128))])]))),128))]),o("div",ee,[o("p",oe," ✓ "+i(r(s).permisos_personalizados.length)+" permisos seleccionados ",1)])])):c("",!0),o("div",se,[u(r(D),{href:n.route("admin.usuarios.index")},{default:p(()=>[u(k,{variant:"ghost"},{default:p(()=>[...e[17]||(e[17]=[_(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),u(k,{type:"submit",variant:"primary",disabled:r(s).processing},{default:p(()=>[_(i(r(s).processing?"Creando...":"Crear Usuario"),1)]),_:1},8,["disabled"])])],32)]),_:1})])])]),_:1})],64))}};export{ue as default};
