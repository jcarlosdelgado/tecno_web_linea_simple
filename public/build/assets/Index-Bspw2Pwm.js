import{r as k,m as h,a as i,b as r,u as d,h as G,w as c,d as e,o as l,F as b,f as w,i as x,t as n,q as R,j as S,k as A,e as g,s as L}from"./app-BlCBzDlk.js";import{_ as O}from"./AuthenticatedLayout-DQ_849qa.js";import{_ as p,a as _}from"./TextInput-CMlWIgSe.js";import{P as $}from"./PrimaryButton-Bp60386B.js";import{_ as B,a as N}from"./SecondaryButton-U9um_d2A.js";import"./Footer-o2Y0PLgd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BzKXVlKb.js";const T={class:"flex justify-between items-center"},H={class:"py-12"},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 text-gray-900"},W={class:"min-w-full leading-normal"},X={class:"px-5 py-5 border-b border-gray-200 bg-white text-sm"},Y={class:"font-medium text-gray-900"},Z={key:0,class:"text-xs text-gray-500"},ee={class:"px-5 py-5 border-b border-gray-200 bg-white text-sm"},oe={class:"px-5 py-5 border-b border-gray-200 bg-white text-sm"},te={key:0},se={class:"font-medium"},re={class:"text-xs text-gray-500"},de={key:1,class:"text-gray-400"},ie={class:"px-5 py-5 border-b border-gray-200 bg-white text-sm"},le=["onClick"],ae=["onClick"],ne=["onClick"],ue={class:"p-6"},ce={class:"text-lg font-medium text-gray-900"},me={class:"mt-6"},pe={class:"grid grid-cols-1 gap-4"},ve={key:0,class:"mt-6 border-t pt-4"},_e={class:"grid grid-cols-1 gap-4"},be=["value"],xe={key:0},ge={class:"mt-6 flex justify-end"},fe={class:"p-6"},ye={class:"text-lg font-medium text-gray-900 mb-4"},ke={key:0,class:"mb-6"},he={class:"space-y-2"},we={class:"flex-1"},Ve={class:"flex items-center gap-2"},Ce={class:"font-medium"},Pe={key:0,class:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full"},Me={class:"text-sm text-gray-600"},Ue=["onClick"],Se={class:"border-t pt-4"},$e={class:"grid grid-cols-1 gap-4"},Ae=["value"],Be={class:"flex items-center"},Ne={class:"mt-6 flex justify-end gap-3"},Re={__name:"Index",props:{materiales:Array,proveedores:Array},setup(V){const f=k(!1),C=k(!1),m=k(null),v=k(null),s=h({nombre:"",descripcion:"",unidad_medida:"",stock_actual:0,stock_minimo:0,id_proveedor:"",precio_unitario:0}),u=h({id_proveedor:"",precio_unitario:0,es_principal:!1}),E=()=>{m.value=null,s.reset(),f.value=!0},j=a=>{m.value=a,s.nombre=a.nombre,s.descripcion=a.descripcion,s.unidad_medida=a.unidad_medida,s.stock_actual=a.stock_actual,s.stock_minimo=a.stock_minimo,f.value=!0},q=a=>{v.value=a,u.reset(),C.value=!0},y=()=>{f.value=!1,s.reset(),m.value=null},P=()=>{C.value=!1,u.reset(),v.value=null},F=()=>{m.value?s.put(route("admin.materiales.update",m.value.id_material),{onSuccess:()=>y()}):s.post(route("admin.materiales.store"),{onSuccess:()=>y()})},I=()=>{u.post(route("admin.materiales.attach-provider",v.value.id_material),{onSuccess:()=>P()})},z=(a,t)=>{confirm("¿Remover este proveedor del material?")&&h({}).delete(route("admin.materiales.detach-provider",[a,t]))},D=a=>{confirm("¿Estás seguro de eliminar este material?")&&h({}).delete(route("admin.materiales.destroy",a))},M=a=>a.proveedores?.find(t=>t.pivot.es_principal);return(a,t)=>(l(),i(b,null,[r(d(G),{title:"Inventario"}),r(O,null,{header:c(()=>[e("div",T,[t[10]||(t[10]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestión de Inventario",-1)),r($,{onClick:E},{default:c(()=>[...t[9]||(t[9]=[g("Nuevo Material",-1)])]),_:1})])]),default:c(()=>[e("div",H,[e("div",J,[e("div",K,[e("div",Q,[e("table",W,[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",{class:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase"},"Nombre"),e("th",{class:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase"},"Unidad"),e("th",{class:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase"},"Stock"),e("th",{class:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase"},"Proveedor Principal"),e("th",{class:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase"},"Acciones")])],-1)),e("tbody",null,[(l(!0),i(b,null,w(V.materiales,o=>(l(),i("tr",{key:o.id_material,class:"hover:bg-gray-50"},[e("td",X,[e("div",Y,n(o.nombre),1),o.descripcion?(l(),i("div",Z,n(o.descripcion),1)):x("",!0)]),e("td",ee,n(o.unidad_medida),1),e("td",{class:R(["px-5 py-5 border-b border-gray-200 bg-white text-sm",{"text-red-600 font-bold":o.stock_actual<=o.stock_minimo}])},n(o.stock_actual)+" / "+n(o.stock_minimo),3),e("td",oe,[M(o)?(l(),i("div",te,[e("div",se,n(M(o).nombre),1),e("div",re,"Bs. "+n(M(o).pivot.precio_unitario),1)])):(l(),i("span",de,"Sin proveedor"))]),e("td",ie,[e("button",{onClick:U=>q(o),class:"text-green-600 hover:text-green-900 mr-3"},"Proveedores ("+n(o.proveedores?.length||0)+")",9,le),e("button",{onClick:U=>j(o),class:"text-blue-600 hover:text-blue-900 mr-3"},"Editar",8,ae),e("button",{onClick:U=>D(o.id_material),class:"text-red-600 hover:text-red-900"},"Eliminar",8,ne)])]))),128))])])])])])]),r(B,{show:f.value,onClose:y},{default:c(()=>[e("div",ue,[e("h2",ce,n(m.value?"Editar Material":"Nuevo Material"),1),e("div",me,[e("div",pe,[e("div",null,[r(p,{for:"nombre",value:"Nombre"}),r(_,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:d(s).nombre,"onUpdate:modelValue":t[0]||(t[0]=o=>d(s).nombre=o),required:""},null,8,["modelValue"])]),e("div",null,[r(p,{for:"unidad",value:"Unidad de Medida"}),r(_,{id:"unidad",type:"text",class:"mt-1 block w-full",modelValue:d(s).unidad_medida,"onUpdate:modelValue":t[1]||(t[1]=o=>d(s).unidad_medida=o),required:""},null,8,["modelValue"])]),e("div",null,[r(p,{for:"stock",value:"Stock Actual"}),r(_,{id:"stock",type:"number",step:"0.01",class:"mt-1 block w-full",modelValue:d(s).stock_actual,"onUpdate:modelValue":t[2]||(t[2]=o=>d(s).stock_actual=o),required:""},null,8,["modelValue"])]),e("div",null,[r(p,{for:"minimo",value:"Stock Mínimo"}),r(_,{id:"minimo",type:"number",step:"0.01",class:"mt-1 block w-full",modelValue:d(s).stock_minimo,"onUpdate:modelValue":t[3]||(t[3]=o=>d(s).stock_minimo=o),required:""},null,8,["modelValue"])])]),m.value?x("",!0):(l(),i("div",ve,[t[13]||(t[13]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Proveedor Inicial (Opcional)",-1)),e("div",_e,[e("div",null,[r(p,{for:"proveedor_inicial",value:"Proveedor"}),S(e("select",{id:"proveedor_inicial","onUpdate:modelValue":t[4]||(t[4]=o=>d(s).id_proveedor=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[12]||(t[12]=e("option",{value:""},"Seleccionar proveedor",-1)),(l(!0),i(b,null,w(V.proveedores,o=>(l(),i("option",{key:o.id_proveedor,value:o.id_proveedor},n(o.nombre),9,be))),128))],512),[[A,d(s).id_proveedor]])]),d(s).id_proveedor?(l(),i("div",xe,[r(p,{for:"precio_inicial",value:"Precio de Compra (Bs.)"}),r(_,{id:"precio_inicial",type:"number",step:"0.01",class:"mt-1 block w-full",modelValue:d(s).precio_unitario,"onUpdate:modelValue":t[5]||(t[5]=o=>d(s).precio_unitario=o)},null,8,["modelValue"])])):x("",!0)])]))]),e("div",ge,[r(N,{onClick:y},{default:c(()=>[...t[14]||(t[14]=[g("Cancelar",-1)])]),_:1}),r($,{class:"ms-3",onClick:F,disabled:d(s).processing},{default:c(()=>[g(n(m.value?"Actualizar":"Guardar"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]),r(B,{show:C.value,onClose:P,"max-width":"3xl"},{default:c(()=>[e("div",fe,[e("h2",ye," Proveedores de: "+n(v.value?.nombre),1),v.value?.proveedores?.length>0?(l(),i("div",ke,[t[15]||(t[15]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Proveedores Actuales",-1)),e("div",he,[(l(!0),i(b,null,w(v.value.proveedores,o=>(l(),i("div",{key:o.id_proveedor,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",we,[e("div",Ve,[e("span",Ce,n(o.nombre),1),o.pivot.es_principal?(l(),i("span",Pe,"Principal")):x("",!0)]),e("div",Me,"Precio: Bs. "+n(o.pivot.precio_unitario),1)]),e("button",{onClick:U=>z(v.value.id_material,o.id_proveedor),class:"text-red-600 hover:text-red-900 text-sm"}," Remover ",8,Ue)]))),128))])])):x("",!0),e("div",Se,[t[18]||(t[18]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Agregar Proveedor",-1)),e("div",$e,[e("div",null,[r(p,{for:"proveedor",value:"Proveedor"}),S(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>d(u).id_proveedor=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[t[16]||(t[16]=e("option",{value:""},"Seleccionar proveedor",-1)),(l(!0),i(b,null,w(V.proveedores,o=>(l(),i("option",{key:o.id_proveedor,value:o.id_proveedor},n(o.nombre),9,Ae))),128))],512),[[A,d(u).id_proveedor]])]),e("div",null,[r(p,{for:"precio",value:"Precio Unitario (Bs.)"}),r(_,{id:"precio",type:"number",step:"0.01",class:"mt-1 block w-full",modelValue:d(u).precio_unitario,"onUpdate:modelValue":t[7]||(t[7]=o=>d(u).precio_unitario=o)},null,8,["modelValue"])]),e("div",Be,[S(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=o=>d(u).es_principal=o),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[L,d(u).es_principal]]),t[17]||(t[17]=e("label",{class:"ml-2 text-sm text-gray-700"},"Marcar como proveedor principal",-1))])])]),e("div",Ne,[r(N,{onClick:P},{default:c(()=>[...t[19]||(t[19]=[g("Cerrar",-1)])]),_:1}),r($,{onClick:I,disabled:d(u).processing||!d(u).id_proveedor},{default:c(()=>[...t[20]||(t[20]=[g(" Agregar Proveedor ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{Re as default};
